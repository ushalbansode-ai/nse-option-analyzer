<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Advanced NSE Option Signals</title>

<style>
    body { font-family: Arial, sans-serif; background: #f5f7fa; padding: 16px; color:#111; }
    .card { background: #fff; padding: 12px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); margin-bottom: 16px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 8px; border-bottom: 1px solid #eee; }
    th { background: #fafafa; text-align: left; }
    h1, h2 { margin-top: 0; }
</style>

</head>
<body>

<h1>Advanced NSE Option Signals</h1>
<p id="updated"></p>

<div class="card">
    <h2>Signals</h2>
    <table id="signalsTable">
        <thead>
            <tr>
                <th>Symbol</th><th>Signal</th><th>Opt</th><th>Strike</th><th>ATM</th>
                <th>LTP</th><th>OI</th><th>COI</th><th>IV</th><th>Score</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<div class="card">
    <h2>Market Overview</h2>
    <table id="marketTable">
        <thead>
            <tr>
                <th>Symbol</th><th>Price</th><th>ATM</th><th>Strikes</th><th>Updated</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
// Load LIVE JSON with anti-cache parameter
fetch("dashboard.json?v=" + Date.now())
    .then(res => res.json())
    .then(data => {

        document.getElementById("updated").innerText =
            "Last Updated: " + data.last_updated;

        // Signals table
        let sRows = "";
        data.signals.forEach(s => {
            sRows += `
                <tr>
                    <td>${s.symbol}</td>
                    <td>${s.signal}</td>
                    <td>${s.option_type}</td>
                    <td>${s.strike}</td>
                    <td>${s.atm}</td>
                    <td>${s.ltp}</td>
                    <td>${s.oi}</td>
                    <td>${s.coi}</td>
                    <td>${s.iv}</td>
                    <td>${s.score}</td>
                </tr>
            `;
        });
        document.querySelector("#signalsTable tbody").innerHTML = sRows;

        // Market Overview table
        let mRows = "";
        data.market.forEach(m => {
            mRows += `
                <tr>
                    <td>${m.symbol}</td>
                    <td>${m.price}</td>
                    <td>${m.atm}</td>
                    <td>${m.strikes}</td>
                    <td>${m.updated}</td>
                </tr>
            `;
        });
        document.querySelector("#marketTable tbody").innerHTML = mRows;

    })
    .catch(err => {
        document.getElementById("updated").innerText = "Failed to load data";
        console.error(err);
    });
</script>

</body>
</html>
